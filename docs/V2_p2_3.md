# 2.3. Project Structure Initialization

This document describes the recommended package and module structure for the `FastMediaSorter_mobile` v2 project. The structure is based on Clean Architecture principles and the MVVM pattern, ensuring separation of concerns, testability, and code scalability.

## 1. General Structure of the `app` Module

The main application logic will be located in the main `:app` module. Inside `app/src/main/java/com/sza/fastmediasorter`, the following package organization is proposed:

```
com.sza.fastmediasorter
├── core                # Common components and utilities for the entire application
│   ├── di              # Hilt modules for dependency injection
│   ├── model           # Common data models used across different layers
│   ├── ui              # Base classes for UI (BaseActivity, BaseFragment, View extensions)
│   └── utils           # Utility classes (file handling, network, dates)
│
├── data                # Data layer: working with data sources
│   ├── local           # Local sources
│   │   └── db            # Room components: Database, DAO, Entities
│   ├── remote          # Remote sources
│   │   ├── smb           # Client for SMB operations
│   │   ├── sftp          # Client for SFTP operations
│   │   └── cloud         # API for cloud storage (Google Drive, etc.)
│   └── repository      # Repository interface implementations from the domain layer
│
├── domain              # Business logic layer (pure Kotlin, no Android dependencies)
│   ├── model           # Business models (POKO - Plain Old Kotlin Objects)
│   ├── repository      # Repository interfaces (contracts for the data layer)
│   └── usecase         # Use cases encapsulating specific business tasks
│
└── ui                  # Presentation layer, organized by features
    ├── main            # Main screen (resource list)
    ├── browse          # Media file browsing and sorting screen
    ├── player          # Player screen
    ├── settings        # Settings screen
    └── resource        # Screens for adding and editing resources
```

### 1.1. Layer Descriptions

-   **`core`**: Contains code that can be reused in any other layer or feature. This includes Dependency Injection setup, base UI classes, immutable data models (e.g., constants), and various helpers.

-   **`data`**: Responsible for providing data to the application. It contains repository implementations, code for working with Room database, network protocols (SMB, SFTP), and cloud APIs. This layer transforms data from raw format (DTO, DB-entity) into domain models.

-   **`domain`**: Contains the core business logic of the application. This layer does not depend on UI implementation details or data sources. It defines *what* the application does. `UseCases` in this layer orchestrate data flow from repositories to achieve business goals.

-   **`ui`**: Responsible for displaying data on the screen and handling user interactions. Each feature (e.g., `main`, `browse`) has its own package containing `Activity`/`Fragment`, `ViewModel`, `Adapter`, and other UI-specific classes. `ViewModel` requests data from `UseCases` and prepares it for display.

## 2. Resource Structure (`res`)

Resources in `app/src/main/res` are also recommended to be organized with prefixes corresponding to the feature for easier navigation:

-   **`layout`**: `activity_main.xml`, `fragment_browse.xml`, `item_resource.xml`
-   **`drawable`**: `ic_browse_filter.xml`, `bg_player_button.xml`
-   **`menu`**: `menu_browse.xml`
-   **`navigation`**: Navigation graphs for Navigation Component, e.g., `nav_main.xml`.

## 3. Test Structure

-   **`app/src/test`**: For local Unit tests. The package structure should mirror the main structure (`data`, `domain`, `ui`) for testing `ViewModels`, `UseCases`, and `Repositories`.
-   **`app/src/androidTest`**: For instrumentation tests requiring Android context (UI testing, Room database testing).

## 4. Action Order

### 4.1. Create Packages
1.  In Android Studio, in `Project` mode, navigate to the folder `app/src/main/java/com/sza/fastmediasorter`.
2.  Create the basic packages: `core`, `data`, `domain`, `ui`.
3.  Within each package, create subpackages according to the proposed structure.

### 4.2. Refactor Existing Code
4.  Start refactoring existing code by moving classes to appropriate packages. For example, database-related classes to `data.local.db`, `Activity`/`Fragment` to corresponding packages within `ui`.
5.  Create base classes (e.g., `BaseActivity`, `BaseViewModel`) in the `core.ui` package for reusing common code.
